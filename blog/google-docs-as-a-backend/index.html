<!doctype html><html lang="en-us"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Quantified Anything: Turning Google Sheets into a Backend Database | Noble Intent Studio</title><meta property="og:title" content="Quantified Anything: Turning Google Sheets into a Backend Database | Noble Intent Studio"><meta name="description" content="Noble Intent Studio"><link rel="canonical" href="https://nobleintentstudio.com/blog/google-docs-as-a-backend/"><meta property="og:url" content="https://nobleintentstudio.com/blog/google-docs-as-a-backend/"><link rel="stylesheet" href="/css/styles.css?t=1587057719176"><meta property="og:image" content="https://nobleintentstudio.com/img/og.jpg"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-56L389S');</script><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"><link rel="manifest" href="/manifest.json"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#19c4cb"><meta name="theme-color" content="#ffffff"><meta http-equiv="x-ua-compatible" content="ie=edge"></head><a href="#main" class="sr">Skip to main content</a><div class="announcement" role="banner">Is Your Website Accessible? <a class="ga-track reversed" data-value="ebook-landing-banner" href="/ultimate-guide-to-website-accessibility/">Get The Guide</a></div><header class="inner-content grey"><h1 class="logo"><a href="/"><span class="sr">Noble Intent Studio</span></a></h1><div class="menu-toggle"><span>Menu</span> <img src="/img/icons/menu--black.svg" alt=""></div><nav class="navigation-menu" role="navigation"><ul><li><a href="/our-work/">Our Work</a></li><li><a href="/about-us/">About Us</a></li><li><a href="/testimonials/">Testimonials</a></li><li><a href="/blog/">Blog</a></li><li><a href="/contact/">Contact</a></li></ul></nav></header><div id="main"></div><article class="blogPost inner-content" role="main"><h1 class="blog__title">Quantified Anything: Turning Google Sheets into a Backend Database</h1><div class="blog__tags"><a href="/blog/#development" class="blog__tag">development</a> <a href="/blog/#hacking" class="blog__tag">hacking</a> <a href="/blog/#google" class="blog__tag">google</a> <a href="/blog/#d3" class="blog__tag">d3</a> <a href="/blog/#data visualization" class="blog__tag">data visualization</a></div><div class="blog__date">April 2, 2015</div><div class="blog__author">by Cris Noble</div><p>The Google Docs suite is great, it offers real-time collaboration and near-feature parity with Microsoft Office (except maybe PowerPoint). One of my favorite things to do is track things, and a Google Sheets (think Excel) is perfect for the task.</p><p>The question that no one is asking but I am going to answer is... "Can I use Google Sheets as a backend database to power a website?" Yes, of course you can! Today we will lay out the groundwork on this technique and continue the fine tradition of using something on the internet for something other than its intended purpose.</p><h2>Setup</h2><p>First things first, let's create the spreadsheet that will drive our application. Bear with me, there is a lot going on.</p><p>Log into <a href="https://drive.google.com/" target="_blank" rel="noopener">Google Drive</a> and create a new Google Sheets.</p><img src="/img/blog/google/new.png" alt="Creating a new Google Doc"><p>I want to populate my data with a simple form, so I am going to hook in a form by selecting <code>Tools&#8594;Create a form</code>.</p><img src="/img/blog/google/form.png" alt="creating a form"><p>This is going to be a simple, one question form with data validation.</p><img src="/img/blog/google/formsetup.png" alt="Form settings"><p>Now I have a very simple way to populate my spreadsheet from my iPhone when I am in my car looking at my odometer.</p><img src="/img/blog/google/formlook.png" alt="Form preview"><p>Each time I use <a href="https://docs.google.com/forms/d/1ejZAk8NJhe_dTJbabLPglieQmf68L1K7F03Ilh42PyQ/viewform" target="_blank" rel="noopener">the form</a>, the timestamp and odometer reading will get put into my spreadsheet automatically.</p><img src="/img/blog/google/filled.png" alt="Google spreadsheet"><p>Just a couple more housekeeping items while we are in our spreadsheet. Go to <code>File&#8594;Publish to the web</code> and then click publish.</p><img src="/img/blog/google/publish.png" alt="Google spreadsheet publishing interface"><p>Next, go to <code>File&#8594;Share</code> and click on the sharable link, this will turn on sharing for anyone with the link.</p><img src="/img/blog/google/share.png" alt="Shareable via link."><p>Feel free to take a peek at <a href="https://docs.google.com/spreadsheets/d/1e4bE5Xk1w1d-N3-xWCYk9ilUA2kFn2TH629lrT_w-Gk/edit?usp=sharing" target="_blank" rel="noopener">my spreadsheet</a>.</p><p>If you look closely at the url, you will be able to find the spreadsheet's key. This is the longish value between the <code>d/</code> and <code>/edit</code>. My key is <code>1e4bE5Xk1w1d-N3-xWCYk9ilUA2kFn2TH629lrT_w-Gk</code>.</p><img src="/img/blog/google/findingTheKey.png" alt="finding the key"><p>You now have all the pieces you need for your website to pull in your spreadsheet's data as JSON, the universal language of the internet's APIs (or at least my preferred one).</p><p>To access your sheet's data as JSON you need to point your browser at <code>https://spreadsheets.google.com/feeds/list/{{yourkey}}/1/public/basic?alt=json-in-script&amp;callback=JSON_CALLBACK</code>, where you replace <code>{{yourkey}}</code> with your key. Keep this url in your back pocket because you will need it shortly. <a href="https://spreadsheets.google.com/feeds/list/1e4bE5Xk1w1d-N3-xWCYk9ilUA2kFn2TH629lrT_w-Gk/1/public/basic?alt=json-in-script&amp;callback=JSON_CALLBACK" target="_blank" rel="noopener">Here is mine</a>.</p><p>If your url does not look like mine, you are using an old version of sheets, or the sheet was created before you upgraded. You can still use this technique, but your JSON url will look like this instead: <code>https://spreadsheets.google.com/feeds/list/{{yourkeyhere}}/od6/public/basic?hl=en_US&amp;alt=json</code> and you can find the key by looking in your sheet's url <code>https://docs.google.com/spreadsheet/ccc?key={{thisiswhereyourkeyis}}#gid=0</code>.</p><p>If you do not see raw JSON that looks like the image below when you visit the JSON url, you are going to have a problem. You need to make sure you have your spreadsheet published, and you have your key correct. This endpoint is not well documented, so you could also try changing the <code>/1/</code> to <code>/2/</code>, I think that piece refers to the "sheet" within your "spreadsheet", with <code>/1/</code> being the leftmost sheet.</p><img src="/img/blog/google/rawApi.png" alt="raw json data"><h2>Pulling in the data</h2><p>Now that we can see the data in JSON, lets get our webpage to see it. If we use jQuery, we can see the data pretty fast.</p><pre>
$.ajax({
  url:'https://spreadsheets.google.com/feeds/list/1e4bE5Xk1w1d-N3-xWCYk9ilUA2kFn2TH629lrT_w-Gk/1/public/basic?alt=json',
  success: function(data){
    console.log(data);
  }
});
</pre><p><a href="http://jsfiddle.net/Lq6avcab/1/" target="_blank" rel="noopener">Check out this jsFiddle</a>, and change the variable <code>JSONURL</code> to your JSON url instead of mine, press run and watch your data fill the screen. A keen observer will notice that we have drilled into the huge JSON object and picked out only the actual cells and their data with this bit of javascript:</p><pre>
var cells = data.feed.entry;
</pre><p>However, this result is still pretty gnarly, so let's turn each row into a nice JSON object. We need to dig into the obscure <code>data.feed.entry</code> array and create a clean <code>rows</code> variable. The code is quite fragile, for example a comma in your number formats will break this particular loop. I recommend using <a href="http://underscorejs.org" target="_blank" rel="noopener">underscore.js</a> to clean it up a bit.</p><pre>
var rows = [];
var cells = data.feed.entry;

for (var i = 0; i &lt; cells.length; i++){
  var rowObj = {};
  rowObj.timestamp = cells[i].title.$t;
  var rowCols = cells[i].content.$t.split(',');
  for (var j = 0; j &lt; rowCols.length; j++){
    var keyVal = rowCols[j].split(':');
    rowObj[keyVal[0].trim()] = keyVal[1].trim();
  }
  rows.push(rowObj);
}
</pre><p>See it in action <a href="http://jsfiddle.net/Lq6avcab/2/" target="_blank" rel="noopener">with this jsFiddle</a>.</p><p>Now that we have a nice clean JSON object to play with, let's clean it up a bit.</p><h2>Displaying the data</h2><p>By using the awesome <a href="http://metricsgraphicsjs.org/" target="_blank" rel="noopener">MetricsGraphics.js</a> library, built on top of D3, we can have a chart in just a few more lines of javascript. <a href="http://jsfiddle.net/Lq6avcab/3/" target="_blank" rel="noopener">See the fiddle for the updated code</a>.</p><img src="/img/blog/google/final.png" alt="final output"><p>Voila! We are now pulling the data from Google sheets, which was populated by a simple mobile-ready form, turning it into a sane JSON object, and visualizing it in chart form.</p><p>I know what you are thinking at this point, why would you go through all of this rigmarole just to do something that Google Sheets does natively?</p><img src="/img/blog/google/sheets.png" alt="google's version"><p>It is true, charts are free, but imagine the possibilities! Plus you can style it however you want.</p><p>Other (dumb) ways you can use this new-found power:</p><ol><li>Set up a shared form where all of your friends input their favorite GIF urls, your webpage could randomly cycle through them.</li><li>You could keep a list of all of the places you have visited, and what you did there. Use the MapBox api to display them as an interactive journaling map.</li><li>A list of books you have read displayed as an awesome timeline.</li></ol><p>What are you going to do with this technique? Let us know in the comments.</p><hr><p>We have demonstrated that it is indeed possible to create a webpage that uses Google docs as its "backend", but should we be doing this? Well, it is free, simple, offers the ability for real-time updates from multiple people, no mysql wizards necessary. On the downside it is slow. Like really slow. I used this technique to <a href="http://qs.noble.io/run/" target="_blank" rel="noopener">visually track my runs</a>, and it can take up to ten seconds to fetch and parse the data. For hackathons and personal projects this is a great way to see data. For anything serious, you are going to want a real database on hand.</p><div class="author"><!--todo--></div><a href="/blog/" class="btn blog__back">Back To All Posts?</a><br><br><div class="comments"><div id="disqus_thread"></div><script>var disqus_config = function () {this.page.url = 'http://nobleintentstudio.com/blog/google-docs-as-a-backend';this.page.identifier = 'Quantified Anything: Turning Google Sheets into a Backend Database | Kovalent Blog';};(function(){var d = document, s = d.createElement('script');s.src = '//kovalent.disqus.com/embed.js';s.setAttribute('data-timestamp', +new Date());(d.head || d.body).appendChild(s);})();</script></div></article><footer role="contentinfo"><div class="inner-content"><h1 class="main-heading">Get In Touch.</h1><div class="grid-wrapper"><div class="column-half"><p>Subscribe to our mailing list.</p><form action="https://nobleintentstudio.glitch.me/subscribe" method="POST" data-thanks="Thank you for subscribing to our email list. We promise not to spam you."><label for="email">Email Address</label> <input type="email" placeholder="email address" name="email" id="email"> <input type="submit" name="submit" value="subscribe" id="subscribe"></form></div><div class="column-half"><p>Send us a message.</p><form action="https://nobleintentstudio.glitch.me/contact" method="POST" data-thanks="Thank you for for submitting your message, we will get back to you as soon as possible."><label for="msg-name">Name</label> <input type="text" placeholder="name" name="msg-name" id="msg-name"> <label for="msg-email">Email</label> <input type="email" placeholder="email address" name="msg-email" id="msg-email"> <label for="msg-message">Message</label> <textarea name="msg-message" id="msg-message" placeholder="message"></textarea> <input type="submit" name="submit" value="submit" id="msg-submit"></form></div></div><div class="social"><a href="https://www.facebook.com/nobleintentstudio"><img src="/img/facebook-icon.png" alt=""> <span class="sr">facebook</span> </a><a href="http://instagram.com/nobleintentstudio"><img src="/img/instagram-icon.png" alt=""> <span class="sr">instagram</span> </a><a href="https://twitter.com/noble_intent"><img src="/img/twitter-icon.png" alt=""> <span class="sr">twitter</span></a></div><div class="meta"><p>Noble Intent Studio</p><p><span class="mobile-full">Highland Avenue &amp; El Cajon Boulevard</span><span class="mobile-hide">, </span><span class="mobile-full">San Diego, CA, 92115</span></p><p><a href="tel:16197191769">+1 619 719 1769</a> | <a href="mailto:info@nobleintentstudio.com">info@nobleintentstudio.com</a></p></div><div class="terms"><a href="/terms/">Terms & Conditions</a><span> | </span><a href="/privacy/">Privacy Policy</a><span> | </span><a href="/disclaimer/">Disclaimer</a></div></div></footer><script src="/js/zepto.min.js?v=3.4.1"></script><script src="/js/app.js?t=1572897750598"></script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Organization","name":"Noble Intent Studio","url":"https://nobleintentstudio.com","sameAs":["https://www.facebook.com/nobleintentstudio","http://instagram.com/nobleintentstudio","https://twitter.com/noble_intent"]}</script></html>